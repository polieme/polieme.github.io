<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"xydcom.cn","root":"/","images":"/images","scheme":"Gemini","version":"8.3.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>
<meta property="og:type" content="article">
<meta property="og:title" content="Docker教程">
<meta property="og:url" content="http://xydcom.cn/2020/07/02/Docker%E6%95%99%E7%A8%8B/index.html">
<meta property="og:site_name" content="Daniel&#39;s Blog技术存放">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://xydcom.cn/images/banner/banner_84.jpg">
<meta property="og:image" content="http://xydcom.cn/2020/07/02/Docker%E6%95%99%E7%A8%8B/screen_shot_1.png">
<meta property="article:published_time" content="2020-07-02T06:19:17.000Z">
<meta property="article:modified_time" content="2021-09-07T02:05:05.840Z">
<meta property="article:author" content="Daniel">
<meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://xydcom.cn/images/banner/banner_84.jpg">


<link rel="canonical" href="http://xydcom.cn/2020/07/02/Docker%E6%95%99%E7%A8%8B/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<title>Docker教程 | Daniel's Blog技术存放</title>
  

  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?54f260792b0ce4401620db3ee3bb5b52";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Daniel's Blog技术存放</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">生死看淡，不服就干</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-java"><a href="/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/Java/" rel="section"><i class="fa fa-bug fa-fw"></i>Java</a></li>
        <li class="menu-item menu-item-javascript"><a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/Javascript/" rel="section"><i class="fab fa-xing fa-fw"></i>Javascript</a></li>
        <li class="menu-item menu-item-jquery"><a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/JQuery/" rel="section"><i class="fa fa-bolt fa-fw"></i>JQuery</a></li>
        <li class="menu-item menu-item-css"><a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80/CSS/" rel="section"><i class="fab fa-css3 fa-fw"></i>CSS</a></li>
        <li class="menu-item menu-item-android"><a href="/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF/Android/" rel="section"><i class="fab fa-android fa-fw"></i>Android</a></li>
        <li class="menu-item menu-item-后端框架"><a href="/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/" rel="section"><i class="fab fa-modx fa-fw"></i>后端框架</a></li>
        <li class="menu-item menu-item-后端插件"><a href="/categories/%E5%90%8E%E7%AB%AF%E6%8F%92%E4%BB%B6/" rel="section"><i class="fab fa-opera fa-fw"></i>后端插件</a></li>
        <li class="menu-item menu-item-前端框架"><a href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/" rel="section"><i class="fa fa-gem fa-fw"></i>前端框架</a></li>
        <li class="menu-item menu-item-前端插件"><a href="/categories/%E5%89%8D%E7%AB%AF%E6%8F%92%E4%BB%B6/" rel="section"><i class="fa fa-crop fa-fw"></i>前端插件</a></li>
        <li class="menu-item menu-item-安全测评"><a href="/categories/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%84/" rel="section"><i class="fa fa-lock fa-fw"></i>安全测评</a></li>
        <li class="menu-item menu-item-办公知识"><a href="/categories/%E5%8A%9E%E5%85%AC%E7%9F%A5%E8%AF%86/" rel="section"><i class="fa fa-dot-circle fa-fw"></i>办公知识</a></li>
        <li class="menu-item menu-item-服务器"><a href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/" rel="section"><i class="fa fa-server fa-fw"></i>服务器</a></li>
        <li class="menu-item menu-item-中间件"><a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/" rel="section"><i class="fa fa-arrows-alt fa-fw"></i>中间件</a></li>
        <li class="menu-item menu-item-数据库"><a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="section"><i class="fa fa-database fa-fw"></i>数据库</a></li>
        <li class="menu-item menu-item-物联网"><a href="/categories/%E7%89%A9%E8%81%94%E7%BD%91/" rel="section"><i class="fa fa-link fa-fw"></i>物联网</a></li>
        <li class="menu-item menu-item-软件安装"><a href="/categories/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/" rel="section"><i class="fa fa-th-large fa-fw"></i>软件安装</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">222</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">103</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">191</span></a></li>
        <li class="menu-item menu-item-待完善"><a href="/todo/" rel="section"><i class="fa fa-paper-plane fa-fw"></i>待完善</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-%E6%95%99%E7%A8%8B"><span class="nav-number">1.</span> <span class="nav-text">Docker 教程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-%E6%95%99%E7%A8%8B-1"><span class="nav-number">1.1.</span> <span class="nav-text">Docker 教程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Docker-%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">1.1.1.</span> <span class="nav-text">Docker 的应用场景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Docker-%E7%9A%84%E4%BC%98%E7%82%B9"><span class="nav-number">1.1.2.</span> <span class="nav-text">Docker 的优点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker%E6%9E%B6%E6%9E%84"><span class="nav-number">1.2.</span> <span class="nav-text">Docker架构</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">2.</span> <span class="nav-text">安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CentOS-Docker%E5%AE%89%E8%A3%85"><span class="nav-number">2.1.</span> <span class="nav-text">CentOS Docker安装</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E4%BD%BF%E7%94%A8"><span class="nav-number">3.</span> <span class="nav-text">Docker使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-Hello-world"><span class="nav-number">3.1.</span> <span class="nav-text">Docker Hello world</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E4%BA%A4%E4%BA%92%E5%BC%8F%E7%9A%84%E5%AE%B9%E5%99%A8"><span class="nav-number">3.1.1.</span> <span class="nav-text">运行交互式的容器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8%EF%BC%88%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%BC%8F%EF%BC%89"><span class="nav-number">3.1.2.</span> <span class="nav-text">启动容器（后台模式）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%81%9C%E6%AD%A2%E5%AE%B9%E5%99%A8"><span class="nav-number">3.1.3.</span> <span class="nav-text">停止容器</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-%E5%AE%B9%E5%99%A8%E4%BD%BF%E7%94%A8"><span class="nav-number">3.2.</span> <span class="nav-text">Docker 容器使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Docker%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="nav-number">3.2.1.</span> <span class="nav-text">Docker客户端</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E4%BD%BF%E7%94%A8"><span class="nav-number">3.2.2.</span> <span class="nav-text">容器使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%AE%B9%E5%99%A8"><span class="nav-number">3.3.</span> <span class="nav-text">删除容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E4%B8%80%E4%B8%AAweb%E5%BA%94%E7%94%A8"><span class="nav-number">3.4.</span> <span class="nav-text">运行一个web应用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8BWEB%E5%BA%94%E7%94%A8"><span class="nav-number">3.5.</span> <span class="nav-text">查看WEB应用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E7%AB%AF%E5%8F%A3%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F"><span class="nav-number">3.6.</span> <span class="nav-text">网络端口快捷方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8BWEB%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%97%A5%E5%BF%97"><span class="nav-number">3.7.</span> <span class="nav-text">查看WEB应用程序日志</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8BWEB%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%AE%B9%E5%99%A8%E7%9A%84%E8%BF%9B%E7%A8%8B"><span class="nav-number">3.8.</span> <span class="nav-text">查看WEB应用程序容器的进程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5WEB%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"><span class="nav-number">3.9.</span> <span class="nav-text">检查WEB应用程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%81%9C%E6%AD%A2WEB%E5%BA%94%E7%94%A8%E5%AE%B9%E5%99%A8"><span class="nav-number">3.10.</span> <span class="nav-text">停止WEB应用容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E5%90%AFWEB%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"><span class="nav-number">3.11.</span> <span class="nav-text">重启WEB应用程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A7%BB%E9%99%A4WEB%E5%BA%94%E7%94%A8%E5%AE%B9%E5%99%A8"><span class="nav-number">3.12.</span> <span class="nav-text">移除WEB应用容器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-%E9%95%9C%E5%83%8F%E4%BD%BF%E7%94%A8"><span class="nav-number">4.</span> <span class="nav-text">Docker 镜像使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%97%E5%87%BA%E9%95%9C%E5%83%8F%E5%88%97%E8%A1%A8"><span class="nav-number">4.1.</span> <span class="nav-text">列出镜像列表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E9%95%9C%E5%83%8F"><span class="nav-number">4.2.</span> <span class="nav-text">获取一个新的镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E9%95%9C%E5%83%8F"><span class="nav-number">4.3.</span> <span class="nav-text">查找镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F"><span class="nav-number">4.4.</span> <span class="nav-text">拉取镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E9%95%9C%E5%83%8F"><span class="nav-number">4.5.</span> <span class="nav-text">删除镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E9%95%9C%E5%83%8F"><span class="nav-number">4.6.</span> <span class="nav-text">创建镜像</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E9%95%9C%E5%83%8F"><span class="nav-number">4.6.1.</span> <span class="nav-text">更新镜像</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F"><span class="nav-number">4.7.</span> <span class="nav-text">构建镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E9%95%9C%E5%83%8F%E6%A0%87%E7%AD%BE"><span class="nav-number">4.8.</span> <span class="nav-text">设置镜像标签</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E5%AE%B9%E5%99%A8%E8%BF%9E%E6%8E%A5"><span class="nav-number">5.</span> <span class="nav-text">Docker容器连接</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B0%E5%BB%BA%E7%BD%91%E7%BB%9C"><span class="nav-number">5.1.</span> <span class="nav-text">新建网络</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E5%AE%B9%E5%99%A8"><span class="nav-number">5.2.</span> <span class="nav-text">连接容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEDNS"><span class="nav-number">5.3.</span> <span class="nav-text">配置DNS</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E4%BB%93%E5%BA%93%E7%AE%A1%E7%90%86"><span class="nav-number">6.</span> <span class="nav-text">Docker仓库管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-Hub"><span class="nav-number">6.1.</span> <span class="nav-text">Docker Hub</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E5%86%8C"><span class="nav-number">6.1.1.</span> <span class="nav-text">注册</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E5%92%8C%E9%80%80%E5%87%BA"><span class="nav-number">6.1.2.</span> <span class="nav-text">登录和退出</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Daniel"
      src="/images/head/head_pic.jpg#/images/avatar.gif">
  <p class="site-author-name" itemprop="name">Daniel</p>
  <div class="site-description" itemprop="description">生死看淡，不服就干</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">191</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">103</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">222</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/polieme" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;polieme" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/polieme@126.com" title="E-Mail → polieme@126.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/polieme" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://xydcom.cn/2020/07/02/Docker%E6%95%99%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head/head_pic.jpg#/images/avatar.gif">
      <meta itemprop="name" content="Daniel">
      <meta itemprop="description" content="生死看淡，不服就干">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Daniel's Blog技术存放">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Docker教程
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-07-02 14:19:17" itemprop="dateCreated datePublished" datetime="2020-07-02T14:19:17+08:00">2020-07-02</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-09-07 10:05:05" itemprop="dateModified" datetime="2021-09-07T10:05:05+08:00">2021-09-07</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">服务器</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E5%AE%B9%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">容器</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/%E5%AE%B9%E5%99%A8/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a>
        </span>
    </span>

  
</div>

            <div class="post-description"> </div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p><img src="/images/banner/banner_84.jpg"></p>
<h2 id="Docker-教程"><a href="#Docker-教程" class="headerlink" title="Docker 教程"></a>Docker 教程</h2><h3 id="Docker-教程-1"><a href="#Docker-教程-1" class="headerlink" title="Docker 教程"></a>Docker 教程</h3><h4 id="Docker-的应用场景"><a href="#Docker-的应用场景" class="headerlink" title="Docker 的应用场景"></a>Docker 的应用场景</h4><ul>
<li>Web应用的自动化打包和发布</li>
<li>自动化测试和持续集成、发布</li>
<li>在服务型环境中部署和调整数据库或其他的后台应用</li>
</ul>
<h4 id="Docker-的优点"><a href="#Docker-的优点" class="headerlink" title="Docker 的优点"></a>Docker 的优点</h4><p>Docker是一个用于开发、交付和运行应用程序的开放平台。DOcker使能够将应用程序与基础架构分开，从而可以快速交付软件。借助Docker，可以与管理应用程序相同的方式来管理基础架构。通过利用Docker的方法来快速交付，测试和部署代码，可以大大减少编写代码和在生产环境中运行代码之间的延迟。</p>
<ol>
<li>快速，一致的交付应用程序<br>Docker允许开发者使用提供的应用程序或服务的本地容器在标准化环境中工作，从而简化了开发的生命周期</li>
</ol>
<ul>
<li>开发者在本地编写代码，并使用Docker容器与同事共享工作</li>
<li>使用Docker将应用程序推送到测试环境中，并执行自动或手动测试</li>
<li>当开发人员发现错误时，他们可以在开发环境中对其进行秀谷，然后将其重新部署到测试环境中，以进行测试和验证</li>
<li>测试完成后，将修补程序推送给生产环境，就像将更新的镜像推送到生产环境一样简单。</li>
</ul>
<ol start="2">
<li>响应式部署和扩展<br>Docker是基于容器的平台，允许高度可移植的工作负载。Docker容器可以在开发人员的本机上，数据中心的物理或虚拟机上，云服务上火混合环境中运行<br>DOcker的可移植性和轻量级的特点，还可以轻松的完成动态管理的工作负担，并根据业务需求指示，实现扩展或拆除应用程序和服务。</li>
<li>在同一硬件上运行更多工作负载<br>Docker轻巧快速。他为基于虚拟机管理程序的虚拟机提供了可行、经济、高效的替代方案，因此您可以利用更多的计算能力来实现业务目标。Docker非常适合高密度环境以及中小型部署，而可以使用更少的资源做更多的事情。</li>
</ol>
<h3 id="Docker架构"><a href="#Docker架构" class="headerlink" title="Docker架构"></a>Docker架构</h3><p>Docker包含三个基本概念</p>
<ul>
<li>镜像（Image）：Docker镜像，就相当于是一个root文件系统。比如官方镜像ubuntu16.04就是包含了完整的一套Ubuntu最小系统的root文件系统</li>
<li>容器（Container）：镜像和容器的关系，就像是面向对象程序设计中的类和实例一样，镜像时静态的定义，容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停。</li>
<li>仓库（Repository）：仓库可看成一个代码控制中心，用来保存镜像。<br>Docker 使用客户端-服务器（C/S）架构模式，使用远程API来管理和创建Docker容器。<br>Docker容器通过Docker镜像来创建。<br>容器和镜像的关系类似于面向对象编程中的对象和类。Docker中容器是对象，镜像是类。<img src="/2020/07/02/Docker%E6%95%99%E7%A8%8B/screen_shot_1.png" class=""></li>
</ul>
<table>
<thead>
<tr>
<th>概念</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Docker镜像（Images）</td>
<td>Docker镜像是用于创建DOcker容器的模板</td>
</tr>
<tr>
<td>Docker容器（Container）</td>
<td>容器是独立运行的一个或一组应用，是镜像运行时的实体</td>
</tr>
<tr>
<td>Docker客户端（Client）</td>
<td>Docker客户端通过命令或其他工具使用Docker SDK(<a target="_blank" rel="noopener" href="https://docs.docker.com/develop/sdk/))%E4%B8%8EDocker%E7%9A%84%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B%EF%BC%88daemon%EF%BC%89%E9%80%9A%E8%AE%AF">https://docs.docker.com/develop/sdk/))与Docker的守护进程（daemon）通讯</a></td>
</tr>
<tr>
<td>Docker主机（Host）</td>
<td>一个物理或者虚拟的机器用于执行Docker守护进程和容器</td>
</tr>
<tr>
<td>Docker Registry</td>
<td>Docker仓库用来保存镜像，可以理解为代码版本控制中的代码仓库 <br> Docker Hub(<a target="_blank" rel="noopener" href="https://hub.docker.com/)%E6%8F%90%E4%BE%9B%E4%BA%86%E5%BA%9E%E5%A4%A7%E7%9A%84%E9%95%9C%E5%83%8F%E9%9B%86%E5%90%88%E4%BE%9B%E4%BD%BF%E7%94%A8">https://hub.docker.com/)提供了庞大的镜像集合供使用</a> <br> 一个Docker Registry中可以包含多个仓库（Repositry）；每个仓库可以包含多个标签（Tag）；每个标签对应一个镜像<br>通常，一个仓库会包含同一个软件不同版本的镜像，而标签就常用于对应的该软件的哥哥版本。我们可以通过<code>&lt;仓库名&gt;:&lt;标签&gt;</code>的格式来制定具体是这个软件那个版本的镜像。如果不给出标签，将以latest作为默认标签</td>
</tr>
<tr>
<td>Docker Machine</td>
<td>Docker Machine是一个简单化Docker安装的命令行工具，通过一个简单的命令就即可在相应的平台上安装Docker</td>
</tr>
</tbody></table>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="CentOS-Docker安装"><a href="#CentOS-Docker安装" class="headerlink" title="CentOS Docker安装"></a>CentOS Docker安装</h3><ol>
<li>如果之前安装过旧的版本，先卸载下<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br></pre></td></tr></table></figure></li>
<li>使用仓库（Repository）安装方式（推荐）<br>首先需要 设置下Docker仓库，然后你可以从仓库中安装或更新Docker</li>
</ol>
<ul>
<li>设置仓库：安装<code>yum-utils</code>包（该包提供<code>yum-config-manager</code> 单元）然后设置稳定版仓库<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum install -y yum-utils</span><br><span class="line"></span><br><span class="line">$ sudo yum-config-manager \</span><br><span class="line">  --add-repo \</span><br><span class="line">  https://download.docker.com/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="3">
<li>安装 Docker 引擎</li>
</ol>
<ul>
<li>安装最新版本的Docker引擎和容器，安装过程中会要求输入两次‘y’<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>
Docker 已经安装完成，但是还没有启动</li>
<li>（安装最新版本的可略过本步骤）安装特定版本的Docker 引擎<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看可用版本</span></span><br><span class="line">$ yum list docker-ce --showduplicates | sort -r</span><br><span class="line">docker-ce.x86_64  3:18.09.1-3.el7                     docker-ce-stable</span><br><span class="line">docker-ce.x86_64  3:18.09.0-3.el7                     docker-ce-stable</span><br><span class="line">docker-ce.x86_64  18.06.1.ce-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.x86_64  18.06.0.ce-3.el7                    docker-ce-stable</span><br></pre></td></tr></table></figure></li>
<li>根据指定版本安装<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum install docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="4">
<li>启动Docker<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl start docker</span><br></pre></td></tr></table></figure></li>
<li>运行<code>hello-world</code>镜像验证是否安装成功，显示<code>This message shows that your installation appears to be working correctly</code>表示安装成功<br>下面这个命令是下载一个测试镜像然后在容器中运行它，当容器运行后，将会打印相关信息然后退出<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker run hello-world</span></span><br><span class="line">Unable to find image <span class="string">&#x27;hello-world:latest&#x27;</span> locally</span><br><span class="line">latest: Pulling from library/hello-world</span><br><span class="line">0e03bdcc26d7: Pull complete</span><br><span class="line">Digest: sha256:d58e752213a51785838f9eed2b7a498ffa1cb3aa7f946dda11af39286c3db9a9</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> hello-world:latest</span><br><span class="line"></span><br><span class="line">Hello from Docker!</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br><span class="line"></span><br><span class="line">To generate this message, Docker took the following steps:</span><br><span class="line"> 1. The Docker client contacted the Docker daemon.</span><br><span class="line"> 2. The Docker daemon pulled the <span class="string">&quot;hello-world&quot;</span> image from the Docker Hub.</span><br><span class="line">    (amd64)</span><br><span class="line"> 3. The Docker daemon created a new container from that image <span class="built_in">which</span> runs the</span><br><span class="line">    executable that produces the output you are currently reading.</span><br><span class="line"> 4. The Docker daemon streamed that output to the Docker client, <span class="built_in">which</span> sent it</span><br><span class="line">    to your terminal.</span><br><span class="line"></span><br><span class="line">To try something more ambitious, you can run an Ubuntu container with:</span><br><span class="line"> $ docker run -it ubuntu bash</span><br><span class="line"></span><br><span class="line">Share images, automate workflows, and more with a free Docker ID:</span><br><span class="line"> https://hub.docker.com/</span><br><span class="line"></span><br><span class="line">For more examples and ideas, visit:</span><br><span class="line"> https://docs.docker.com/get-started/</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Docker使用"><a href="#Docker使用" class="headerlink" title="Docker使用"></a>Docker使用</h2><h3 id="Docker-Hello-world"><a href="#Docker-Hello-world" class="headerlink" title="Docker Hello world"></a>Docker Hello world</h3><p>Docker 允许你在容器内运行应用程序，使用<code>docker run</code>命令来在容器内运行一个应用程序</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-xxx-2-l</span><br><span class="line">- docker:docker的二进制执行文件</span><br><span class="line">- run:与前面的docker组合来运行一个容器</span><br><span class="line">- `ubuntu:15.10`:指定要运行的镜像，Docker首先从本地主机上查找镜像是否存在，如果不存在，Docker就会从镜像仓库Docker Hub下载公共镜像</span><br><span class="line">- `/bin/<span class="built_in">echo</span> <span class="string">&quot;Hello World&quot;</span>`:在启动的容器里面执行的命令</span><br><span class="line">完整意思：Docker以ubuntu15.10镜像创建一个新的容器，然后在容器里面执行bin/<span class="built_in">echo</span> <span class="string">&quot;Hello world&quot;</span>，然后输出结果；当然也可以尝试下面的命令，会进入一个新的系统幺：</span><br><span class="line">```bash</span><br><span class="line">[root@hecs-x-xxxx-2-linux-xxxxx ~]<span class="comment"># docker run -it ubuntu bash</span></span><br><span class="line">root@70b1006ae6a1:/<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h4 id="运行交互式的容器"><a href="#运行交互式的容器" class="headerlink" title="运行交互式的容器"></a>运行交互式的容器</h4><p>我们通过docker的两个参数-i -t，让docker运行的容器实现“对话”的能力</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker run -it ubuntu:15.10 /bin/bash</span></span><br><span class="line"><span class="comment"># 进入一个ubuntu15.10系统的容器</span></span><br><span class="line">root@686f91a07af0:/<span class="comment">#</span></span><br></pre></td></tr></table></figure>
<p>各个参数解析：</p>
<ul>
<li>-t：在新容器内指定一个伪终端或终端</li>
<li>-i：允许你对容器内的标准输入（STDIN）进行交互</li>
</ul>
<p>我们可以以通过exit命令或者Ctrl+D退出容器</p>
<h4 id="启动容器（后台模式）"><a href="#启动容器（后台模式）" class="headerlink" title="启动容器（后台模式）"></a>启动容器（后台模式）</h4><p>使用一下命令创建一个以<font color='red'>进程方式</font>运行的容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker run -d ubuntu:15.10 /bin/sh -c &quot;while true;do echo hello world;sleep1;done&quot;</span></span><br><span class="line">2698163a0d659bd4d98d7ad3ec8dd6eb3027fb529dcc4159b8b2cef2a505724b</span><br></pre></td></tr></table></figure>
<p>在输出中，我们没有看到期望的“hello world”，而是一串长字符<br>2698163a0d659bd4d98d7ad3ec8dd6eb3027fb529dcc4159b8b2cef2a505724b<br>在这个长字符串叫做容器ID，对每个容器来说都是唯一的，我们可以通过容器ID来查看对应的容器发生了什么<br>首先，需要确认容器有在运行，可以通过docker ps 查看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker ps</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES</span><br><span class="line">2698163a0d65        ubuntu:15.10        <span class="string">&quot;/bin/sh -c &#x27;while t…&quot;</span>   2 minutes ago       Up 2 minutes                            flamboyant_golick</span><br><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>
<ul>
<li>CONTAINER ID：容器ID</li>
<li>IMAGE：使用的镜像</li>
<li>COMMAND：启动容器时运行的命令</li>
<li>CREATED：创建时间</li>
<li>STATUS：容器状态<ul>
<li>created：已创建</li>
<li>restarting：重启中</li>
<li>running：运行中</li>
<li>removing：前一种</li>
<li>paused：暂停</li>
<li>exited：停止</li>
<li>dead：死亡</li>
</ul>
</li>
<li>PORTS：容器的端口信息和使用的连接类型（tcp/udp）</li>
<li>NAMES：自动分配的容器名称</li>
</ul>
<p>在宿主主机内使用docker logs命令，查看容器内的标准输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]# docker logs 2b1b7a428627</span><br></pre></td></tr></table></figure>

<h4 id="停止容器"><a href="#停止容器" class="headerlink" title="停止容器"></a>停止容器</h4><p>shiyong <code>docker stop</code>命令来停止容器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]# docker stop 2b1b7a428627</span><br></pre></td></tr></table></figure>

<h3 id="Docker-容器使用"><a href="#Docker-容器使用" class="headerlink" title="Docker 容器使用"></a>Docker 容器使用</h3><h4 id="Docker客户端"><a href="#Docker客户端" class="headerlink" title="Docker客户端"></a>Docker客户端</h4><p>docker客户端非常简单，可以输入docker命令查看Docker客户端的所有命令选项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker</span></span><br><span class="line"></span><br><span class="line">Usage:	docker [OPTIONS] COMMAND</span><br><span class="line"></span><br><span class="line">A self-sufficient runtime <span class="keyword">for</span> containers</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">      --config string      Location of client config files (default <span class="string">&quot;/root/.docker&quot;</span>)</span><br><span class="line">  -c, --context string     Name of the context to use to connect to the daemon (overrides DOCKER_HOST env var and default context <span class="built_in">set</span> with <span class="string">&quot;docker context use&quot;</span>)</span><br><span class="line">  -D, --debug              Enable debug mode</span><br><span class="line">  -H, --host list          Daemon socket(s) to connect to</span><br><span class="line">  -l, --log-level string   Set the logging level (<span class="string">&quot;debug&quot;</span>|<span class="string">&quot;info&quot;</span>|<span class="string">&quot;warn&quot;</span>|<span class="string">&quot;error&quot;</span>|<span class="string">&quot;fatal&quot;</span>) (default <span class="string">&quot;info&quot;</span>)</span><br><span class="line">      --tls                Use TLS; implied by --tlsverify</span><br><span class="line">      --tlscacert string   Trust certs signed only by this CA (default <span class="string">&quot;/root/.docker/ca.pem&quot;</span>)</span><br><span class="line">      --tlscert string     Path to TLS certificate file (default <span class="string">&quot;/root/.docker/cert.pem&quot;</span>)</span><br><span class="line">      --tlskey string      Path to TLS key file (default <span class="string">&quot;/root/.docker/key.pem&quot;</span>)</span><br><span class="line">      --tlsverify          Use TLS and verify the remote</span><br><span class="line">  -v, --version            Print version information and quit</span><br><span class="line"></span><br><span class="line">Management Commands:</span><br><span class="line">  builder     Manage builds</span><br><span class="line">  config      Manage Docker configs</span><br><span class="line">  container   Manage containers</span><br><span class="line">  context     Manage contexts</span><br><span class="line">  engine      Manage the docker engine</span><br><span class="line">  image       Manage images</span><br></pre></td></tr></table></figure>

<p>可以通过docker command –help 更深入的了解指定的Docker命令使用方法<br>例如我们要查看docker stats指令的具体使用方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker stats --help</span></span><br><span class="line"></span><br><span class="line">Usage:	docker stats [OPTIONS] [CONTAINER...]</span><br><span class="line"></span><br><span class="line">Display a live stream of container(s) resource usage statistics</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -a, --all             Show all containers (default shows just running)</span><br><span class="line">      --format string   Pretty-print images using a Go template</span><br><span class="line">      --no-stream       Disable streaming stats and only pull the first result</span><br><span class="line">      --no-trunc        Do not truncate output</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="容器使用"><a href="#容器使用" class="headerlink" title="容器使用"></a>容器使用</h4><ol>
<li><p>获取镜像<br>如果本地没有ubuntu镜像，我们可以使用<code>docker pull</code>命令里载入ubuntu镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker pull ubuntu</span></span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from library/ubuntu</span><br><span class="line">Digest: sha256:35c4a2c15539c6c1e4e5fa4e554dac323ad0107d8eb5c582d6ff386b383b7dce</span><br><span class="line">Status: Image is up to date <span class="keyword">for</span> ubuntu:latest</span><br><span class="line">docker.io/library/ubuntu:latest</span><br><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker pull centos</span></span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from library/centos</span><br><span class="line">6910e5a164f7: Pull complete</span><br><span class="line">Digest: sha256:4062bbdd1bb0801b0aa38e0f83dece70fb7a5e9bce223423a68de2d8b784b43b</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> centos:latest</span><br><span class="line">docker.io/library/centos:latest</span><br></pre></td></tr></table></figure></li>
<li><p>启动容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker run -it centos /bin/bash</span></span><br><span class="line">[root@92f340d92240 /]<span class="comment"># docker ps</span></span><br><span class="line">bash: docker: <span class="built_in">command</span> not found</span><br><span class="line">[root@92f340d92240 /]<span class="comment"># exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure></li>
<li><p>启动已停止运行的容器<br>查看所有的容器命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED              STATUS                            PORTS               NAMES</span><br><span class="line">83e3a5b2c60f        centos              <span class="string">&quot;/bin/bash&quot;</span>              About a minute ago   Exited (0) About a minute ago                         blissful_wright</span><br><span class="line">92f340d92240        centos              <span class="string">&quot;/bin/bash&quot;</span>              About a minute ago   Exited (127) About a minute ago                       priceless_burnell</span><br><span class="line">2698163a0d65        ubuntu:15.10        <span class="string">&quot;/bin/sh -c &#x27;while t…&quot;</span>   25 minutes ago       Exited (137) 19 minutes ago                           flamboyant_golick</span><br><span class="line">686f91a07af0        ubuntu:15.10        <span class="string">&quot;/bin/bash&quot;</span>              34 minutes ago       Exited (0) 30 minutes ago                             epic_tereshkova</span><br><span class="line">3ae7d786d261        ubuntu:15.10        <span class="string">&quot;/bin/echo &#x27;Hello Wo…&quot;</span>   18 hours ago         Exited (0) 18 hours ago                               vigilant_payne</span><br></pre></td></tr></table></figure>
<p>使用docker start 启动一个已停止的容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker start 92f340d92240</span></span><br></pre></td></tr></table></figure></li>
<li><p>后台运行<br>在大部分场景下，我们希望docker的服务是在后台运行的，我们可以通过<code>-d</code>指定容器的运行模式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker run -itd --name ubuntu-test ubuntu:15.10 /bin/sh</span></span><br><span class="line">dd3cff7cf16a8e73187be4fb62e411822d9ffc81f1870e9078a1b9f777d3f652</span><br></pre></td></tr></table></figure>
<p><font color='red'>注：</font>加了<code>-d</code>参数默认不会进入容器，想要进入容器要使用指令<code>docker exec</code></p>
</li>
<li><p>停止/重启一个容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker stop &lt;容器ID&gt;</span><br></pre></td></tr></table></figure>
<p>容器可以通过<code>docker restart</code>重启</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker restart  dd3cff7cf16a</span></span><br><span class="line">dd3cff7cf16a</span><br></pre></td></tr></table></figure></li>
<li><p>进入容器<br>在使用<code>-d</code>参数的时候，容器启动会进入后台。此时如果想要进入容器，可以通过下面指令进入</p>
</li>
</ol>
<ul>
<li>docker attach</li>
<li>docker exec:推荐使用该命令，因为此退出容器中断，不会导致容器停止</li>
</ul>
<p>下面演示使用docker exec 命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker exec -it dd3cff7cf16a /bin/bash</span></span><br><span class="line">root@dd3cff7cf16a:/<span class="comment"># exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker ps</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</span><br><span class="line">dd3cff7cf16a        ubuntu:15.10        <span class="string">&quot;/bin/sh&quot;</span>           23 minutes ago      Up 18 minutes                           ubuntu-test</span><br></pre></td></tr></table></figure>
<p>可以看到上面的退出之后，容器还是在运行着的<br>5. 导出和导入容器<br>如果要导出本地某个容器，可以使用<code>docker export</code>命令，使用下面的命令就可以导出容器快照到本地</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxxx ~]<span class="comment"># docker export dd3cff7cf16a &gt; ubuntu.tar.gz</span></span><br><span class="line">[root@hecs-x-medium-2-linux-xxxxx ~]<span class="comment"># ls</span></span><br><span class="line">ubuntu.tar.gz</span><br></pre></td></tr></table></figure>

<p>导入容器快照<br>可以使用<code>docker import</code>从容器快照文件中在导入镜像，以下实例快照ubuntu.tar.gz 导入到镜像test/ubuntu:v1</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># cat ubuntu.tar.gz|docker import - test/ubuntu:v1</span></span><br><span class="line">sha256:8837160e99131307a3b98bc357624a6a883888b3ec7cb6837f08388012538ab7</span><br></pre></td></tr></table></figure>
<p>此外，也可以通过URL或者某个目录导入，例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxxx ~]<span class="comment">#  docker import http://example.com/exampleimage.tgz example/imagerepo</span></span><br></pre></td></tr></table></figure>

<h3 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h3><p>删除容器使用<code>docker rm</code> 命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxxx ~]<span class="comment"># docker rm -f dd3cff7cf16a</span></span><br><span class="line">dd3cff7cf16a</span><br></pre></td></tr></table></figure>
<p>下面这个命令可以清零掉所有处于终止状态的容器</p>
<h3 id="运行一个web应用"><a href="#运行一个web应用" class="headerlink" title="运行一个web应用"></a>运行一个web应用</h3><p>下面将在docker 容器中运行一个Python Flask应用来运行一个web应用<br>首先把镜像拉去下来</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker pull training/webapp</span></span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from training/webapp</span><br></pre></td></tr></table></figure>
<p>然后运行镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker run -d -P training/webapp python app.py</span></span><br><span class="line">a9c60ebe355aa679fa9989a36b5b3ecbf22a66ddbc854e38258d9250c9c7c0e8</span><br><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker ps</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                     NAMES</span><br><span class="line">a9c60ebe355a        training/webapp     <span class="string">&quot;python app.py&quot;</span>     5 seconds ago       Up 3 seconds        0.0.0.0:32768-&gt;5000/tcp   bold_ellis</span><br><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>-d:让容器在后台运行</li>
<li>-P：将容器内部使用的网络端口随机映射到我们使用的主机上</li>
</ul>
<h3 id="查看WEB应用"><a href="#查看WEB应用" class="headerlink" title="查看WEB应用"></a>查看WEB应用</h3><p>使用docker ps 来查看我们正在运行的容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker ps</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED              STATUS              PORTS                     NAMES</span><br><span class="line">a9c60ebe355a        training/webapp     <span class="string">&quot;python app.py&quot;</span>     About a minute ago   Up About a minute   0.0.0.0:32768-&gt;5000/tcp   bold_ellis</span><br></pre></td></tr></table></figure>
<p>这里多了端口信息(PORTS)<br>Docker 开放了5000端口映射到主机端口32768端口上，我们可以使用浏览器访问WEB应用<br>也可以通过-p参数来设置不一样的端口</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]$ docker run -d -p 5000:5000 training/webapp python app.py</span><br><span class="line">84f844338385cb95414ae1c15b3227a0a6017a96c3f7bd5f12b30f2223c89e36</span><br><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]$ docker ps -a</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                        PORTS                    NAMES</span><br><span class="line">84f844338385        training/webapp     <span class="string">&quot;python app.py&quot;</span>     12 seconds ago      Up 11 seconds                 0.0.0.0:5000-&gt;5000/tcp   strange_bassi</span><br></pre></td></tr></table></figure>

<h3 id="网络端口快捷方式"><a href="#网络端口快捷方式" class="headerlink" title="网络端口快捷方式"></a>网络端口快捷方式</h3><p>通过<code>docker ps</code>可以查看端口映射情况，docker 还提供了另一个快捷方式<code>docker port</code>，可以指定容器ID查看端口情况</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker port 84f844338385</span></span><br><span class="line">5000/tcp -&gt; 0.0.0.0:5000</span><br><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="查看WEB应用程序日志"><a href="#查看WEB应用程序日志" class="headerlink" title="查看WEB应用程序日志"></a>查看WEB应用程序日志</h3><p>docker logs[ID或者名字] 可以查看容器内部的标准日志输出</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxxxx ~]<span class="comment"># docker logs aa53c237d4e5</span></span><br><span class="line"> * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)</span><br><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>
<p>-f: 让 docker logs 像使用 tail -f 一样来输出容器内部的标准输出。</p>
<h3 id="查看WEB应用程序容器的进程"><a href="#查看WEB应用程序容器的进程" class="headerlink" title="查看WEB应用程序容器的进程"></a>查看WEB应用程序容器的进程</h3><p>我们还可以通过<code>docker top </code>来查看容器内部的运行进程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxxx ~]<span class="comment"># docker top aa53c237d4e5</span></span><br><span class="line">UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD</span><br><span class="line">root                3627                3611                0                   08:59               ?                   00:00:00            python app.py</span><br></pre></td></tr></table></figure>

<h3 id="检查WEB应用程序"><a href="#检查WEB应用程序" class="headerlink" title="检查WEB应用程序"></a>检查WEB应用程序</h3><p>使用<code>docker inspect</code> 来查看docker的底层信息。它会返回一个JSON文件记录着Docker容器的配置和状态信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker inspect aa53c237d4e5</span></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;Id&quot;</span>: <span class="string">&quot;aa53c237d4e5ef476203c3712ed9b60ac929ededc1df6f659ad8535d451739ed&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Created&quot;</span>: <span class="string">&quot;2020-07-06T00:59:34.605869182Z&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Path&quot;</span>: <span class="string">&quot;python&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Args&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;app.py&quot;</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&quot;State&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;Status&quot;</span>: <span class="string">&quot;running&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Running&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">&quot;Paused&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">&quot;Restarting&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">&quot;OOMKilled&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">&quot;Dead&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">&quot;Pid&quot;</span>: 3627,</span><br><span class="line">            <span class="string">&quot;ExitCode&quot;</span>: 0,</span><br><span class="line">            <span class="string">&quot;Error&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;StartedAt&quot;</span>: <span class="string">&quot;2020-07-06T00:59:34.851310537Z&quot;</span>,</span><br><span class="line">            <span class="string">&quot;FinishedAt&quot;</span>: <span class="string">&quot;0001-01-01T00:00:00Z&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;Image&quot;</span>: <span class="string">&quot;sha256:6fae60ef344644649a39240b94d73b8ba9c67f898ede85cf8e947a887b3e6557&quot;</span>,</span><br><span class="line">        <span class="string">&quot;ResolvConfPath&quot;</span>: <span class="string">&quot;/var/lib/docker/containers/aa53c237d4e5ef476203c3712ed9b60ac929ededc1df6f659ad8535d451739ed/resolv.conf&quot;</span>,</span><br><span class="line">        <span class="string">&quot;HostnamePath&quot;</span>: <span class="string">&quot;/var/lib/docker/containers/aa53c237d4e5ef476203c3712ed9b60ac929ededc1df6f659ad8535d451739ed/hostname&quot;</span>,</span><br><span class="line">        <span class="string">&quot;HostsPath&quot;</span>: <span class="string">&quot;/var/lib/docker/containers/aa53c237d4e5ef476203c3712ed9b60ac929ededc1df6f659ad8535d451739ed/hosts&quot;</span>,</span><br><span class="line">        <span class="string">&quot;LogPath&quot;</span>: <span class="string">&quot;/var/lib/docker/containers/aa53c237d4e5ef476203c3712ed9b60ac929ededc1df6f659ad8535d451739ed/aa53c237d4e5ef476203c3712ed9b60ac929ededc1df6f659ad8535d451739ed-json.log&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;/laughing_hofstadter&quot;</span>,</span><br><span class="line">        <span class="string">&quot;RestartCount&quot;</span>: 0,</span><br><span class="line">        <span class="string">&quot;Driver&quot;</span>: <span class="string">&quot;overlay2&quot;</span>,</span><br><span class="line">.....</span><br></pre></td></tr></table></figure>

<h3 id="停止WEB应用容器"><a href="#停止WEB应用容器" class="headerlink" title="停止WEB应用容器"></a>停止WEB应用容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker stop aa53c237d4e5</span></span><br><span class="line">aa53c237d4e5</span><br><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="重启WEB应用程序"><a href="#重启WEB应用程序" class="headerlink" title="重启WEB应用程序"></a>重启WEB应用程序</h3><p>已经停止的容器，我们可以使用命令<code>docker start</code>来启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker start aa53c237d4e5</span></span><br><span class="line">aa53c237d4e5</span><br><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>
<p><code>docker ps -l</code>查询最后一次创建的容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker ps -l</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">aa53c237d4e5        training/webapp     <span class="string">&quot;python app.py&quot;</span>     22 minutes ago      Up 46 seconds       0.0.0.0:5000-&gt;5000/tcp   laughing_hofstadter</span><br></pre></td></tr></table></figure>
<p>正在运行的容器，我们可以使用<code>docker restart</code>命令来重启</p>
<h3 id="移除WEB应用容器"><a href="#移除WEB应用容器" class="headerlink" title="移除WEB应用容器"></a>移除WEB应用容器</h3><p>我们可以使用<code>docker rm</code>命令来删除不需要的容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker rm aa53c237d4e5</span></span><br><span class="line">aa53c237d4e5</span><br><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>
<p>删除容器时，容器必须是停止状态，否则会报如下错误</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker rm aa53c237d4e5</span></span><br><span class="line">Error response from daemon: You cannot remove a running container aa53c237d4e5ef476203c3712ed9b60ac929ededc1df6f659ad8535d451739ed. Stop the container before attempting removal or force remove</span><br><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="Docker-镜像使用"><a href="#Docker-镜像使用" class="headerlink" title="Docker 镜像使用"></a>Docker 镜像使用</h2><p>当运行容器时，使用的镜像如果在本地中不存在，docker就会自动从docker镜像仓库中下载，默认是<code>Docker Hub</code>公共镜像源下载</p>
<h3 id="列出镜像列表"><a href="#列出镜像列表" class="headerlink" title="列出镜像列表"></a>列出镜像列表</h3><p>我们可以使用<code>docker images</code>来列出本地主机上的镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line"><span class="built_in">test</span>/ubuntu         v1                  8837160e9913        2 days ago          119MB</span><br><span class="line">ubuntu              latest              74435f89ab78        2 weeks ago         73.9MB</span><br><span class="line">centos              latest              831691599b88        2 weeks ago         215MB</span><br><span class="line">hello-world         latest              bf756fb1ae65        6 months ago        13.3kB</span><br><span class="line">ubuntu              15.10               9b9cb95443b5        3 years ago         137MB</span><br><span class="line">training/webapp     latest              6fae60ef3446        5 years ago         349MB</span><br></pre></td></tr></table></figure>
<p>各个选项说明：</p>
<ul>
<li>REPOSITORY：表示镜像的仓库源</li>
<li>TAG：镜像的标签</li>
<li>IMAGE ID：镜像ID</li>
<li>CREATED：镜像创建时间</li>
<li>SIZE：镜像大小<br>同一个仓库源可以有多个TAG，代表这个仓库源的不同个版本，使用REPOSITORY:TAG来定义不同的镜像<h3 id="获取一个新的镜像"><a href="#获取一个新的镜像" class="headerlink" title="获取一个新的镜像"></a>获取一个新的镜像</h3>当在本地主机上使用一个不存在的镜像时Docker就会自动下载这个镜像。如果我们想预先下载这个镜像，我们可以使用<code>docker pull</code>命令下载它。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker pull centos</span></span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from library/centos</span><br><span class="line">Digest: sha256:4062bbdd1bb0801b0aa38e0f83dece70fb7a5e9bce223423a68de2d8b784b43b</span><br><span class="line">Status: Image is up to date <span class="keyword">for</span> centos:latest</span><br><span class="line">docker.io/library/centos:latest</span><br></pre></td></tr></table></figure>
下载完成后，我们可以直接使用这个镜像来运行容器。<h3 id="查找镜像"><a href="#查找镜像" class="headerlink" title="查找镜像"></a>查找镜像</h3>可以从Docker Hub网站来搜索镜像，Docker Hub的网址为：<a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com/</a><br>可以使用<code>docker search</code>命令来搜索镜像。比如我们需要一个<code>httpd</code>的镜像来作为我们的web服务。我们可以通过<code>docker search</code>命令搜索httpd来寻找适合我们的镜像<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker search httpd</span></span><br><span class="line">NAME                                    DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED</span><br><span class="line">httpd                                   The Apache HTTP Server Project                  3088                [OK]                </span><br><span class="line">centos/httpd-24-centos7                 Platform <span class="keyword">for</span> running Apache httpd 2.4 or bui…   33                                      </span><br><span class="line">centos/httpd                                                                            29                                      [OK]</span><br><span class="line">arm32v7/httpd                           The Apache HTTP Server Project                  9                                       </span><br><span class="line">salim1983hoop/httpd24                   Dockerfile running apache config                2                                       [OK]</span><br><span class="line">lead4good/httpd-fpm                     httpd server <span class="built_in">which</span> connects via fcgi proxy h…   1                                       [OK]</span><br><span class="line">solsson/httpd-openidc                   mod_auth_openidc on official httpd image, ve…   1                                       [OK]</span><br><span class="line">jonathanheilmann/httpd-alpine-rewrite   httpd:alpine with enabled mod_rewrite           1                                       [OK]</span><br><span class="line">publici/httpd                           httpd:latest                                    1                                       [OK]</span><br><span class="line">clearlinux/httpd                        httpd HyperText Transfer Protocol (HTTP) ser…   1                                       </span><br><span class="line">......</span><br></pre></td></tr></table></figure></li>
<li>NAME：镜像仓库源的名称</li>
<li>DESCRIPTION：镜像的描述</li>
<li>OFFICIAL：是否docker官方发布</li>
<li>STARS:类似github里面的star，表示点赞、喜欢的意思</li>
<li>AUTOMATED：自动构建</li>
</ul>
<h3 id="拉取镜像"><a href="#拉取镜像" class="headerlink" title="拉取镜像"></a>拉取镜像</h3><p>使用上面的httpd官方版本的镜像，使用docker pull来下载镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxxx ~]<span class="comment"># docker pull httpd</span></span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from library/httpd</span><br><span class="line">8559a31e96f4: Downloading [============&gt;                                      ]  6.716MB/27.1MB</span><br><span class="line">bd517d441028: Download complete</span><br><span class="line">f67007e59c3c: Downloading [===&gt;                                               ]  772.6kB/10.37MB</span><br><span class="line">83c578481926: Waiting</span><br><span class="line">f3cbcb88690d: Waiting</span><br></pre></td></tr></table></figure>
<p>下载完成后，我们就可以运行这个镜像了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker run httpd</span></span><br></pre></td></tr></table></figure>

<h3 id="删除镜像"><a href="#删除镜像" class="headerlink" title="删除镜像"></a>删除镜像</h3><p>镜像删除使用<code>docker rmi</code>命令，比如我们删除</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker rmi hello-world</span></span><br><span class="line">Untagged: hello-world:latest</span><br><span class="line">Untagged: hello-world@sha256:d58e752213a51785838f9eed2b7a498ffa1cb3aa7f946dda11af39286c3db9a9</span><br><span class="line">Deleted: sha256:bf756fb1ae65adf866bd8c456593cd24beb6a0a061dedf42b26a993176745f6b</span><br><span class="line">Deleted: sha256:9c27e219663c25e0f28493790cc0b88bc973ba3b1686355f221c38a36978ac63</span><br></pre></td></tr></table></figure>
<h3 id="创建镜像"><a href="#创建镜像" class="headerlink" title="创建镜像"></a>创建镜像</h3><p>当从docker镜像仓库中下载的镜像不能满足我们的需求时，我们可以通过以下两种方式对镜像进行更改</p>
<ul>
<li>从已经创建的容器中更新镜像，并且提交这个镜像</li>
<li>使用Dockerfile指令来创建一个新的镜像</li>
</ul>
<h4 id="更新镜像"><a href="#更新镜像" class="headerlink" title="更新镜像"></a>更新镜像</h4><p>更新镜像之前，需要使用镜像来创建一个容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker run -it ubuntu:15.10 /bin/bash</span></span><br><span class="line">root@79b87b167653:/<span class="comment"># apt-get update</span></span><br></pre></td></tr></table></figure>
<p>在运行的容器内使用 <code>apt-get update</code> 命令进行更新<br>在完成操作之后，输入<code>exit</code>命令退出容器<br>此时刚刚运行的容器就是我们更改后的容器，可以通过docker commit提交容器副本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker commit -m=&quot;Test commit&quot; -a=&quot;daniel&quot;  a39b5e9c2b8c smartcore/ubuntu:v2</span></span><br><span class="line">sha256:179f46c4f9063855e8685f899fcxxxxxb3763124684a9a126c79e4d136988</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>-m:提交说明</li>
<li>-a:镜像作者</li>
<li>a39b5e9c2b8c:容器ID</li>
<li>smartcore/ubuntu:v2：指定要创建的目标镜像名<br>使用<code>docker images</code>命令查看我们的新镜像<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">smartcore/ubuntu    v2                  179f46c4f906        50 minutes ago      349MB</span><br></pre></td></tr></table></figure>
使用新镜像启动一个容器<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">smartcore/ubuntu    v2                  179f46c4f906        50 minutes ago      349MB</span><br><span class="line">[root@hecs-x-medium-2-linux-xxxx ~]<span class="comment"># docker run -it smartcore/ubuntu:v2 /bin/bash</span></span><br><span class="line">root@a98626036409:/opt/webapp<span class="comment">#   </span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="构建镜像"><a href="#构建镜像" class="headerlink" title="构建镜像"></a>构建镜像</h3><p>使用命令<code>docker build</code>，从零开始创建一个新的镜像。为此，我们需要创建一个Dockerfile文件，其中包含一卒之令来告诉Docker如何构建镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx docker]<span class="comment"># cat Dockerfile</span></span><br><span class="line">FROM centos:7.2.1511</span><br><span class="line">MAINTAINER Fisher <span class="string">&quot;Daniel&quot;</span></span><br><span class="line">RUN /bin/<span class="built_in">echo</span> <span class="string">&#x27;root:xydtech123&#x27;</span>|chpasswd</span><br><span class="line">RUN useradd sem</span><br><span class="line">RUN /bin/<span class="built_in">echo</span> <span class="string">&#x27;sem:xydtech123&#x27;</span>|chpasswd</span><br><span class="line">RUN /bin/<span class="built_in">echo</span> -e <span class="string">&quot;LANG=\&quot;en_US.UTF-8\&quot;&quot;</span> &gt;/etc/default/<span class="built_in">local</span></span><br><span class="line">EXPOSE 22</span><br><span class="line">EXPOSE 80</span><br><span class="line">CMD /usr/sbin/sshd -D</span><br></pre></td></tr></table></figure>
<p>每一个指令都会在镜像上创建一个新的层，每一个指令的前缀都必须是大写的<br>第一条FROM，指定使用哪个镜像源<br>RUN指令告诉docker 在镜像内执行命令，安装了什么<br>然后，我们使用Dockerfile文件，通过<code>docker build</code>(注意最后还有个点，是指定Dockerfile的目录)命令来构建一个镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx docker]# docker build -t sem&#x2F;centos:7.2.1511 .</span><br><span class="line">Sending build context to Docker daemon  2.048kB</span><br><span class="line">Step 1&#x2F;9 : FROM centos:7.2.1511</span><br><span class="line"> ---&gt; 9aec5c5fe4ba</span><br><span class="line">Step 2&#x2F;9 : MAINTAINER Fisher &quot;Daniel&quot;</span><br><span class="line"> ---&gt; Running in 8445c6f27d59</span><br><span class="line">Removing intermediate container 8445c6f27d59</span><br><span class="line"> ---&gt; 95e03a3fd461</span><br><span class="line">Step 3&#x2F;9 : RUN &#x2F;bin&#x2F;echo &#39;root:xydtech123&#39;|chpasswd</span><br><span class="line"> ---&gt; Running in 43fbc2461433</span><br><span class="line">Removing intermediate container 43fbc2461433</span><br><span class="line"> ---&gt; 87c6207f2280</span><br><span class="line">Step 4&#x2F;9 : RUN useradd sem</span><br><span class="line"> ---&gt; Running in 80a7d1c778b5</span><br><span class="line">Removing intermediate container 80a7d1c778b5</span><br><span class="line"> ---&gt; a407d4394f54</span><br><span class="line">.......</span><br></pre></td></tr></table></figure>
<p>参数说明:</p>
<ul>
<li>-t:指定要创建的目标镜像名<br>.:Dockerfile文件所在目录，可以指定Dockerfile的绝对路径<br>使用docker images查看创建的镜像已经在列表中存在，镜像ID为：9a52aadd3648<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-xxxx docker]<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">sem/centos          7.2.1511            9a52aadd3648        47 seconds ago      195MB</span><br><span class="line">smartcore/ubuntu    v2                  179f46c4f906        About an hour ago   349MB</span><br></pre></td></tr></table></figure>
使用新的镜像创建容器<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]<span class="comment"># docker run -it sem/centos:7.2.1511 /bin/bash</span></span><br><span class="line">[root@5393673efc17 /]<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">[root@5393673efc17 /]<span class="comment"># id sem</span></span><br><span class="line">uid=1000(sem) gid=1000(sem) groups=1000(sem)</span><br></pre></td></tr></table></figure>
从上面的新镜像已经包含了上面创建的用户sem<h3 id="设置镜像标签"><a href="#设置镜像标签" class="headerlink" title="设置镜像标签"></a>设置镜像标签</h3>可以通过docker tag命令，为镜像添加一个新的标签</li>
</ul>
<ol>
<li>首先使用docker images 查看目前已有的镜像<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">sem/centos          7.2.1511            9a52aadd3648        13 minutes ago      195MB</span><br></pre></td></tr></table></figure></li>
<li>把IMAGE ID为9a52aadd3648的TAG修改为7.2<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]<span class="comment"># docker tag 9a52aadd3648 daniel/centos:v3</span></span><br><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">sem/centos          7.2                 9a52aadd3648        3 hours ago         195MB</span><br><span class="line">sem/centos          7.2.1511            9a52aadd3648        3 hours ago         195MB</span><br><span class="line">daniel/centos       v3                  9a52aadd3648        3 hours ago         195MB</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Docker容器连接"><a href="#Docker容器连接" class="headerlink" title="Docker容器连接"></a>Docker容器连接</h2><h3 id="新建网络"><a href="#新建网络" class="headerlink" title="新建网络"></a>新建网络</h3><p>首先使用命令<code>docker network create</code>创建一个新的Docker网络，然后使用命令<code>docker network ls</code>查看建立的网络</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]# docker network create -d bridge test-net</span><br><span class="line">786b44147e9e885c65e6ee5597832027acd2d48daf49074a495e8f5502a91a13</span><br><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]# docker network ls</span><br><span class="line">NETWORK ID          NAME                DRIVER              SCOPE</span><br><span class="line">fc82f80ad8ea        bridge              bridge              local</span><br><span class="line">663856490eac        host                host                local</span><br><span class="line">6bf6dea57a12        none                null                local</span><br><span class="line">786b44147e9e        test-net            bridge              local</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>-d：参数指定Docker网络类型，有bridge，overlay<h3 id="连接容器"><a href="#连接容器" class="headerlink" title="连接容器"></a>连接容器</h3>运行两个新的容器并连接到新建的<code>test-net</code>网络：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]# docker run -itd --name&#x3D;&quot;test1&quot; --network test-net centos:7 &#x2F;bin&#x2F;bash</span><br><span class="line">Unable to find image &#39;centos:7&#39; locally</span><br><span class="line">7: Pulling from library&#x2F;centos</span><br><span class="line">524b0c1e57f8: Pull complete</span><br><span class="line">Digest: sha256:e9ce0b76f29f942502facd849f3e468232492b259b9d9f076f71b392293f1582</span><br><span class="line">Status: Downloaded newer image for centos:7</span><br><span class="line">ed51b979348a00dcce6f0147bff04a5685f39625f4620dd2d11527385ec523e6</span><br><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</span><br><span class="line">ed51b979348a        centos:7            &quot;&#x2F;bin&#x2F;bash&quot;         5 seconds ago       Up 5 seconds                            test1</span><br><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]# docker run -itd --name&#x3D;&quot;test2&quot; --network test-net centos:7 &#x2F;bin&#x2F;bash</span><br><span class="line">78846bd75ddb85801af29423d9d153f533e7595e6bcf687e50bf1f95cc948dd6</span><br><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</span><br><span class="line">78846bd75ddb        centos:7            &quot;&#x2F;bin&#x2F;bash&quot;         3 seconds ago       Up 2 seconds                            test2</span><br><span class="line">ed51b979348a        centos:7            &quot;&#x2F;bin&#x2F;bash&quot;         17 seconds ago      Up 16 seconds                           test1</span><br></pre></td></tr></table></figure>
测试两个容器之间的网络<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@78846bd75ddb /]<span class="comment"># ping test1</span></span><br><span class="line">PING test1 (172.18.0.2) 56(84) bytes of data.</span><br><span class="line">64 bytes from test1.test-net (172.18.0.2): icmp_seq=1 ttl=64 time=0.052 ms</span><br><span class="line">64 bytes from test1.test-net (172.18.0.2): icmp_seq=2 ttl=64 time=0.050 ms</span><br><span class="line">--- test1 ping statistics ---</span><br><span class="line">2 packets transmitted, 2 received, 0% packet loss, time 999ms</span><br><span class="line">rtt min/avg/max/mdev = 0.050/0.051/0.052/0.001 ms</span><br><span class="line">[root@78846bd75ddb /]<span class="comment"># ping test2</span></span><br><span class="line">PING test2 (172.18.0.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from 78846bd75ddb (172.18.0.3): icmp_seq=1 ttl=64 time=0.015 ms</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="配置DNS"><a href="#配置DNS" class="headerlink" title="配置DNS"></a>配置DNS</h3><ol>
<li>统一设置DNS配置信息<br>可以在宿主机的/etc/docker/daemon.json文件中增加以下内容来设置全部容器的DNS<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;dns&quot;</span>:[</span><br><span class="line">		<span class="string">&quot;144.144.144.144&quot;</span>,</span><br><span class="line">		<span class="string">&quot;8.8.8.8&quot;</span></span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
设置后，启动容器的DNS会自动配置为144.144.144.144和8.8.8.8<br>配置完，需要重启docker才能生效<code>service docker restart</code><br>查看容器的DNS是否生效可以使用一下命令，它会输出容器的DNS信息：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]<span class="comment"># service docker restart</span></span><br><span class="line">Redirecting to /bin/systemctl restart  docker.service</span><br><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]<span class="comment"># service  docker status</span></span><br><span class="line">Redirecting to /bin/systemctl status  docker.service</span><br><span class="line">● docker.service - Docker Application Container Engine</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/docker.service; disabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Tue 2020-07-07 15:54:12 CST; 16s ago</span><br><span class="line">     Docs: https://docs.docker.com</span><br><span class="line"> Main PID: 9989 (dockerd)</span><br><span class="line">    Tasks: 9</span><br><span class="line">   Memory: 42.8M</span><br><span class="line">   CGroup: /system.slice/docker.service</span><br><span class="line">           └─9989 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span><br><span class="line">......</span><br><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]<span class="comment"># docker ps -a</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                            PORTS               NAMES</span><br><span class="line">78846bd75ddb        centos:7            <span class="string">&quot;/bin/bash&quot;</span>         24 minutes ago      Exited (137) About a minute ago                       test2</span><br><span class="line">ed51b979348a        centos:7            <span class="string">&quot;/bin/bash&quot;</span>         25 minutes ago      Exited (137) About a minute ago                       test1</span><br><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]<span class="comment"># docker start 78846bd75ddb ed51b979348a</span></span><br><span class="line">78846bd75ddb</span><br><span class="line">ed51b979348a</span><br><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]<span class="comment"># docker run -it --rm ubuntu  cat etc/resolv.conf</span></span><br><span class="line">search openstacklocal</span><br><span class="line">nameserver 144.144.144.144</span><br><span class="line">nameserver 8.8.8.8</span><br><span class="line">options single-request-reopen</span><br><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]<span class="comment">#</span></span><br></pre></td></tr></table></figure></li>
<li>手动指定容器配置<br>如果指向在指定的容器设置DNS，则可以使用一下命令：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-20200701102124 docker]<span class="comment"># docker run -it --rm -h host_ubuntu --dns=114.114.114.114 --dns-search=test.com ubuntu</span></span><br><span class="line">root@host_ubuntu:/<span class="comment">#</span></span><br></pre></td></tr></table></figure>
参数说明：</li>
</ol>
<ul>
<li>-h HOSTNAME或者–hostname=HOSTNAME :设定容器的主机名，他会被卸载容器的/etc/hostname和/etc/hosts</li>
<li>–dns=IP_ADDRESS:添加DNS服务器到容器的/etc/resolv.cnf中，让容器用这个服务器来解析所有不在/etc/hosts中的主机名</li>
<li>–dns-search=DOMAIN：设定容器的搜索域，当设定搜索域为example.com时，在搜索一个名为host的主机时，DNS不仅搜索host，还会搜索host.example.com</li>
</ul>
<p>如果在容器启动时没有指定–dns和–dns-search，Docker会默认用宿主主机上的/etc/resolv.conf来配置容器的DNS</p>
<h2 id="Docker仓库管理"><a href="#Docker仓库管理" class="headerlink" title="Docker仓库管理"></a>Docker仓库管理</h2><p>仓库是集中存放镜像的地方，下面简单介绍下<code>Docker Hub</code>。目前仓库的服务商有很多，但操作都是一样的</p>
<h3 id="Docker-Hub"><a href="#Docker-Hub" class="headerlink" title="Docker Hub"></a>Docker Hub</h3><p>目前Docker官方维护的一个公共仓库<a target="_blank" rel="noopener" href="https://hub.docker.com/">Docker Hub</a><br>大部分需求都可以通过在Docker Hub上直接下载镜像来实现</p>
<h4 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h4><p>在Docker hub上免费注册一个Docker账号</p>
<h4 id="登录和退出"><a href="#登录和退出" class="headerlink" title="登录和退出"></a>登录和退出</h4><p>登录需要输入用户名和密码，登录成功后，我们可以从docker hub上拉去自己账号下面的全部镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@hecs-x-medium-2-linux-20200701102124 ~]<span class="comment"># docker login</span></span><br><span class="line">Login with your Docker ID to push and pull images from Docker Hub. If you don<span class="string">&#x27;t have a Docker ID, head over to https://hub.docker.com to create one.</span></span><br><span class="line"><span class="string">Username: donkeyzp</span></span><br><span class="line"><span class="string">Password:</span></span><br><span class="line"><span class="string">WARNING! Your password will be stored unencrypted in /root/.docker/config.json.</span></span><br><span class="line"><span class="string">Configure a credential helper to remove this warning. See</span></span><br><span class="line"><span class="string">https://docs.docker.com/engine/reference/commandline/login/#credentials-store</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Login Succeeded</span></span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Docker/" rel="tag"># Docker</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/07/01/Linux-%E5%85%A5%E4%BE%B5%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%E6%80%9D%E8%B7%AF/" rel="prev" title="Linux 入侵问题排查思路">
                  <i class="fa fa-chevron-left"></i> Linux 入侵问题排查思路
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/07/09/Windows-CentOS%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%BC%95%E5%AF%BC%E4%BF%AE%E5%A4%8D/" rel="next" title="Windows-CentOS双系统引导修复">
                  Windows-CentOS双系统引导修复 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>







<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">鲁ICP备19005853号-1 </a>
  </div>

<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Daniel</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  
<script src="/js/local-search.js"></script>






  





</body>
</html>
